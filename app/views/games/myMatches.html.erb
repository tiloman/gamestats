<h1>Meine Spiele</h1>

<% @matches_days.each do |day| %>
  <div class="date">
    <%= day[0].strftime("%d. %b %Y") %>
  </div>

  <% @matches.each do |match| %>
  <% if match.created_at.strftime("%d. %b %Y") == day[0].strftime("%d. %b %Y") %>

    <% player1 = User.find(match.player1) %>
    <% player2 = User.find(match.player2) %>

    <div class='card'>
      <% if win_or_lose(match) == "Win" %>
        <div class='card-body won'>
      <% elsif win_or_lose(match) == "Lose" %>
        <div class='card-body lost'>
      <% else %>
        <div class='card-body'>
      <% end %>

      <h5>

        <%= link_to player1 do %>
          <div class="avatar left">
            <%= image_tag(player1.avatar.url(:thumb))%>
          </div>
        <% end %>
        <%= link_to player2 do %>
          <div class="avatar right">
            <%= image_tag(player2.avatar.url(:thumb))%>
          </div>
        <% end %>

        <%= link_to "#{player1.vorname} vs. #{player2.vorname}", match, class:'card-title' %>
      </h5>

      <h6 class='card-subtitle text-muted'>
          <%= match.game %>
      </h6>

      <div class='result'>
        <%= match.scoreplayer1 %>
        :
        <%= match.scoreplayer2 %>
      </div>

      <br>

      <% if match.user == current_user %>
        <%= link_to 'Edit', edit_match_path(match), class:'card-link' %>
        <%= link_to 'Destroy', match, method: :delete, data: { confirm: 'Are you sure?' }, class:'card-link' %>
      <% end %>

      <div class='timestamp'>
        <%= date_format(match.created_at) %>
      </div>
    </div>
    </div>
  <% end %>
<% end %>
<% end %>
